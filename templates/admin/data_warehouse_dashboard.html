{% extends "clinical_base.html" %}

{% block title %}数据仓库管理 - 医学临床科研专病数据管理平台{% endblock %}

{% block sidebar %}
<!-- 这里不添加侧边栏内容，以便主内容区域能够占据更多空间 -->
{% endblock %}

{% block content %}
<!-- 添加自定义样式 -->
<style>
/* 覆盖基础模板中的样式，确保内容居中 */
.col-md-9.col-lg-10.clinical-content {
    flex: 0 0 100% !important;
    max-width: 100% !important;
    padding: 15px !important;
}

/* 隐藏侧边栏 */
.col-md-3.col-lg-2.clinical-sidebar {
    display: none !important;
}

.dashboard-container {
    width: 90%;
    margin-left: auto;
    margin-right: auto;
    padding: 0 20px;
    box-sizing: border-box;
    max-width: 1800px;
}

/* 确保页面内容在任何缩放比例下都居中 */
@media (min-width: 1200px) {
    .dashboard-container {
        width: 90%;
    }
}

@media (min-width: 992px) and (max-width: 1199px) {
    .dashboard-container {
        width: 95%;
    }
}

@media (max-width: 991px) {
    .dashboard-container {
        width: 98%;
    }
}
</style>

<div class="dashboard-container">
    <div class="content-title text-center">
        专病库管理 <i class="bi bi-database-fill info-icon"></i>
    </div>

    <div class="row mb-4">
        <div class="col-md-12">
            <div class="clinical-info-box">
                <div class="info-box-title">
                    GeniusMed-Vault临床专病数据库
                </div>
                <div class="info-box-content text-center">
                    <div class="warehouse-diagram">
                        <!-- 数据仓库图形表示 -->
                        <div class="warehouse-cylinder">
                            <div class="cylinder-text">GeniusMed-Vault临床专病数据库</div>
                        </div>
                    </div>
                    
                    <div class="warehouse-stats mt-4">
                        <div class="row justify-content-center">
                            <div class="col-md-3">
                                <div class="stat-box">
                                    <div class="stat-value">{{ warehouse_size|default('5.2') }} TB</div>
                                    <div class="stat-label">总存储容量</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-box">
                                    <div class="stat-value">{{ integration_count|default('18') }}</div>
                                    <div class="stat-label">集成接口数量</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-box">
                                    <div class="stat-value">{{ data_centers|default('6') }}</div>
                                    <div class="stat-label">数据中心数量</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-box">
                                    <div class="stat-value">{{ active_services|default('12') }}</div>
                                    <div class="stat-label">活跃服务</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- 左侧：医院信息集成与交换平台 -->
        <div class="col-md-6">
            <div class="clinical-info-box">
                <div class="info-box-title d-flex align-items-center">
                    <i class="bi bi-hdd-network me-2"></i> 医院信息集成与交换平台
                </div>
                <div class="info-box-content">
                    <div id="integration" class="warehouse-section mb-4">
                        <h5><i class="bi bi-diagram-3"></i> 集成引擎</h5>
                        <p>医疗信息系统集成核心引擎，用于处理不同系统间的数据处理与转换。</p>
                        <div class="d-flex justify-content-between">
                            <span class="badge bg-success">状态: 运行中</span>
                            <div>
                                <button class="clinical-button btn-sm">配置</button>
                                <button class="clinical-button btn-sm">查看日志</button>
                            </div>
                        </div>
                    </div>
                    
                    <div id="sso" class="warehouse-section mb-4">
                        <h5><i class="bi bi-key"></i> 单点登录</h5>
                        <p>统一身份认证系统，支持多系统账户整合与安全访问控制。</p>
                        <div class="d-flex justify-content-between">
                            <span class="badge bg-success">状态: 运行中</span>
                            <div>
                                <button class="clinical-button btn-sm">管理用户</button>
                                <button class="clinical-button btn-sm">查看日志</button>
                            </div>
                        </div>
                    </div>
                    
                    <div id="services" class="warehouse-section mb-4">
                        <h5><i class="bi bi-gear"></i> 集成服务</h5>
                        <p>数据集成基础服务组件，提供数据转换、清洗和整合能力。</p>
                        <table class="clinical-table mt-2">
                            <thead>
                                <tr>
                                    <th>服务名称</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>数据同步服务</td>
                                    <td><span class="badge bg-success">运行中</span></td>
                                    <td><button class="clinical-button btn-sm">管理</button></td>
                                </tr>
                                <tr>
                                    <td>数据转换服务</td>
                                    <td><span class="badge bg-success">运行中</span></td>
                                    <td><button class="clinical-button btn-sm">管理</button></td>
                                </tr>
                                <tr>
                                    <td>数据验证服务</td>
                                    <td><span class="badge bg-warning">警告</span></td>
                                    <td><button class="clinical-button btn-sm">管理</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="service-management" class="warehouse-section mb-4">
                        <h5><i class="bi bi-sliders"></i> 集成服务管理</h5>
                        <p>集成服务配置与监控管理平台，支持服务发布与维护。</p>
                        <button class="clinical-button mb-2">新增服务</button>
                        <button class="clinical-button mb-2">服务配置</button>
                    </div>
                    
                    <div id="monitoring" class="warehouse-section mb-4">
                        <h5><i class="bi bi-display"></i> 服务监控</h5>
                        <p>实时监控系统服务运行状态、性能与异常。</p>
                        <div class="chart-placeholder bg-light p-3 text-center">
                            [服务监控图表]
                        </div>
                    </div>
                    
                    <div id="interconnect" class="warehouse-section">
                        <h5><i class="bi bi-arrow-left-right"></i> 互联互通服务</h5>
                        <p>支持与外部系统的数据交换与互操作。</p>
                        <div class="d-flex justify-content-between">
                            <span class="badge bg-success">状态: 运行中</span>
                            <div>
                                <button class="clinical-button btn-sm">查看连接</button>
                                <button class="clinical-button btn-sm">添加连接</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 右侧：医疗数据资源平台 -->
        <div class="col-md-6">
            <div class="clinical-info-box">
                <div class="info-box-title d-flex align-items-center">
                    <i class="bi bi-database-fill me-2"></i> 医疗数据资源平台
                </div>
                <div class="info-box-content">
                    <div id="medical-records" class="warehouse-section mb-4">
                        <h5><i class="bi bi-file-earmark-text"></i> 病历共享文档</h5>
                        <p>电子病历与医疗文档集中存储与共享系统。</p>
                        <div class="stats-small">
                            <div class="stat-item">
                                <span class="stat-value">{{ doc_count|default('105,234') }}</span>
                                <span class="stat-label">文档总数</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">{{ doc_size|default('480') }} GB</span>
                                <span class="stat-label">存储容量</span>
                            </div>
                        </div>
                        <button class="clinical-button mt-2">管理文档</button>
                    </div>
                    
                    <div id="patient-index" class="warehouse-section mb-4">
                        <h5><i class="bi bi-person-badge"></i> 患者主索引</h5>
                        <p>患者唯一标识与基础信息主数据管理。</p>
                        <div class="stats-small">
                            <div class="stat-item">
                                <span class="stat-value">{{ patient_count|default('68,421') }}</span>
                                <span class="stat-label">患者总数</span>
                            </div>
                        </div>
                        <button class="clinical-button mt-2">查询患者</button>
                    </div>
                    
                    <div id="imaging" class="warehouse-section mb-4">
                        <h5><i class="bi bi-image"></i> 医学影像中心</h5>
                        <p>医学影像PACS系统集成与存储管理。</p>
                        <div class="stats-small">
                            <div class="stat-item">
                                <span class="stat-value">{{ image_count|default('254,103') }}</span>
                                <span class="stat-label">影像总数</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">{{ image_size|default('2.1') }} TB</span>
                                <span class="stat-label">存储容量</span>
                            </div>
                        </div>
                        <button class="clinical-button mt-2">影像管理</button>
                    </div>
                    
                    <div id="standard-data" class="warehouse-section mb-4">
                        <h5><i class="bi bi-card-checklist"></i> 标准数据集</h5>
                        <p>医疗数据标准化与规范管理系统。</p>
                        <table class="clinical-table mt-2">
                            <thead>
                                <tr>
                                    <th>标准集</th>
                                    <th>版本</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>临床诊断数据集</td>
                                    <td>v2.3</td>
                                    <td><button class="clinical-button btn-sm">管理</button></td>
                                </tr>
                                <tr>
                                    <td>用药数据集</td>
                                    <td>v1.8</td>
                                    <td><button class="clinical-button btn-sm">管理</button></td>
                                </tr>
                                <tr>
                                    <td>实验室检查数据集</td>
                                    <td>v2.1</td>
                                    <td><button class="clinical-button btn-sm">管理</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="master-data" class="warehouse-section mb-4">
                        <h5><i class="bi bi-database"></i> 主数据/术语</h5>
                        <p>医疗术语标准与主数据管理系统。</p>
                        <div class="list-group">
                            <a href="#" class="list-group-item list-group-item-action">ICD-10 疾病分类</a>
                            <a href="#" class="list-group-item list-group-item-action">医院科室代码</a>
                            <a href="#" class="list-group-item list-group-item-action">药品编码目录</a>
                            <a href="#" class="list-group-item list-group-item-action">检验项目代码</a>
                        </div>
                    </div>
                    
                    <div id="research-data" class="warehouse-section mb-4">
                        <h5><i class="bi bi-journal-medical"></i> 科研数据中心</h5>
                        <p>临床研究数据集管理与分析平台。</p>
                        <div class="stats-small">
                            <div class="stat-item">
                                <span class="stat-value">{{ research_datasets|default('24') }}</span>
                                <span class="stat-label">研究数据集</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">{{ research_projects|default('8') }}</span>
                                <span class="stat-label">进行中项目</span>
                            </div>
                        </div>
                        <button class="clinical-button mt-2">数据集管理</button>
                    </div>
                    
                    <div id="clinical-data" class="warehouse-section mb-4">
                        <h5><i class="bi bi-clipboard-pulse"></i> 临床数据中心</h5>
                        <p>临床数据综合管理与查询分析平台。</p>
                        <div class="progress mb-2" style="height: 20px;">
                            <div class="progress-bar" role="progressbar" style="width: 65%;" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100">65%</div>
                        </div>
                        <small>数据整合进度: 65%</small>
                        <button class="clinical-button mt-2">查看详情</button>
                    </div>
                    
                    <div id="operations-data" class="warehouse-section">
                        <h5><i class="bi bi-graph-up"></i> 运营数据中心</h5>
                        <p>医院运营管理数据统计分析平台。</p>
                        <div class="chart-placeholder bg-light p-3 text-center">
                            [运营数据分析图表]
                        </div>
                        <button class="clinical-button mt-2">生成报告</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* 数据仓库页面专用样式 */
.warehouse-cylinder {
    width: 200px;
    height: 120px;
    background-color: #17a2b8;
    border-radius: 100px / 40px;
    margin: 0 auto;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
}

.cylinder-text {
    color: white;
    font-weight: bold;
    font-size: 1.25rem;
}

.warehouse-section {
    border-bottom: 1px solid #eaeaea;
    padding-bottom: 20px;
    margin-bottom: 20px;
}

.warehouse-section:last-child {
    border-bottom: none;
}

.stats-small {
    display: flex;
    justify-content: start;
    gap: 20px;
    margin-top: 10px;
}

.stat-item {
    display: flex;
    flex-direction: column;
}

.stat-value {
    font-weight: bold;
    font-size: 1.1rem;
    color: #0056b3;
}

.stat-label {
    font-size: 0.85rem;
    color: #6c757d;
}

.stat-box {
    background-color: #f8f9fa;
    border-radius: 8px;
    padding: 15px;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.stat-box .stat-value {
    font-size: 1.5rem;
    color: #0056b3;
    font-weight: bold;
}

.stat-box .stat-label {
    font-size: 0.9rem;
    color: #6c757d;
}

.chart-placeholder {
    border-radius: 5px;
    min-height: 150px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #6c757d;
}
</style>
{% endblock %} 